<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Project Stories | Mehrzad Golabi</title>
  <meta name="description" content="Project stories by Mehrzad Golabi: snippets, images, languages, and learnings.">
  <link rel="canonical" href="https://mehrzadgolabi.github.io/projects.html">
  <meta name="theme-color" content="#2d3e50">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vazirmatn@33.0.3/Vazirmatn-font-face.css">
  <style>
    :root {
      --primary-color: #2d3e50;
      --secondary-color: #3498db;
      --text-color: #333;
      --light-bg: #f9f9f9;
      --dark-bg: #2c3e50;
      --card-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    [data-theme="dark"] {
      --primary-color: #e6edf3;
      --secondary-color: #58a6ff;
      --text-color: #e6edf3;
      --light-bg: #0d1117;
      --dark-bg: #161b22;
      --card-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; color: var(--text-color); background: var(--light-bg); }
    .container { max-width: 1100px; margin: 0 auto; padding: 0 20px; }

    header { background: var(--dark-bg); color: #fff; padding: 16px 0; position: sticky; top: 0; z-index: 10; }
    .nav { display:flex; align-items:center; justify-content:space-between; }
    .nav a { color:#fff; text-decoration:none; margin-left:16px; }
    .nav .right { display:flex; align-items:center; gap:10px; }
    .toggle { background: rgba(255,255,255,0.2); padding:6px 10px; border-radius:16px; cursor:pointer; }

    .page-hero { padding: 60px 0 20px; }
    .page-hero h1 { font-size: 2rem; }
    .page-hero p { color:#666; margin-top:6px; }

    .stories { display:grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; padding: 30px 0 80px; }
    .story { background:#fff; border-radius:10px; box-shadow: var(--card-shadow); overflow:hidden; display:flex; flex-direction:column; }
    .thumb { width:100%; height: 160px; object-fit:cover; background:#ddd; }
    .story-body { padding:16px; display:flex; flex-direction:column; gap:10px; }
    .story h3 { color: var(--primary-color); }
    .meta { display:flex; flex-wrap:wrap; gap:10px; color:#666; font-size:0.9rem; }
    .chip { padding:4px 10px; border-radius: 14px; background: rgba(52,152,219,0.15); color: var(--secondary-color); font-weight:600; }
    pre { background:#0f172a; color:#e5e7eb; padding:12px; border-radius:8px; overflow:auto; font-size:0.9rem; }
    code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    .story a.btn { align-self:flex-start; text-decoration:none; color:#fff; background: var(--secondary-color); border-radius:6px; padding:8px 12px; font-weight:600; }

    [data-theme="dark"] .story { background:#11161d; }
    [data-theme="dark"] .page-hero p, [data-theme="dark"] .meta { color:#9aa4b2; }

    footer { background: var(--dark-bg); color:#fff; padding: 14px 0; text-align:center; }
  </style>
</head>
<body>
  <header>
    <div class="container nav">
      <div>
        <a href="index.html" aria-label="Home"><strong>Mehrzad<span style="color:var(--secondary-color)">Golabi</span></strong></a>
      </div>
      <div class="right">
        <a href="index.html#repositories" data-i18n="nav.repositories">Repositories</a>
        <a href="projects.html" data-i18n="nav.stories">Project Stories</a>
        <div class="toggle" id="lang-toggle"><i class="fas fa-language"></i></div>
        <div class="toggle" id="theme-toggle"><i class="fas fa-moon"></i></div>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="page-hero">
      <h1 data-i18n="stories.title">Project Stories</h1>
      <p data-i18n="stories.subtitle">Selected highlights with images, snippets, and learnings.</p>
    </section>

    <section class="stories" id="stories"></section>
  </main>

  <footer>
    <div class="container">© <span id="year"></span> Mehrzad Golabi</div>
  </footer>

  <script>
    const translations = {
      en: {
        nav: { repositories: 'Repositories', stories: 'Project Stories' },
        stories: { title: 'Project Stories', subtitle: 'Selected highlights with images, snippets, and learnings.', learnings: 'Learnings', view: 'View Project' }
      },
      fa: {
        nav: { repositories: 'پروژه‌ها', stories: 'داستان پروژه‌ها' },
        stories: { title: 'داستان پروژه‌ها', subtitle: 'گزیده‌هایی همراه با تصویر، قطعه‌کد و آموخته‌ها.', learnings: 'آموخته‌ها', view: 'مشاهده پروژه' }
      }
    };

    // Theme & language
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme) document.documentElement.setAttribute('data-theme', savedTheme);
    function setTheme(theme) {
      document.documentElement.setAttribute('data-theme', theme); localStorage.setItem('theme', theme);
      document.querySelector('#theme-toggle i').className = theme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
    }
    setTheme(document.documentElement.getAttribute('data-theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'));
    document.getElementById('theme-toggle').addEventListener('click', () => setTheme(document.documentElement.getAttribute('data-theme') === 'dark' ? 'light' : 'dark'));

    let currentLang = localStorage.getItem('language') || 'en';
    function setLanguage(lang) {
      currentLang = lang; localStorage.setItem('language', lang);
      document.documentElement.setAttribute('dir', lang === 'fa' ? 'rtl' : 'ltr');
      document.documentElement.setAttribute('lang', lang);
      document.querySelectorAll('[data-i18n]').forEach(el => {
        const keys = el.getAttribute('data-i18n').split('.');
        let value = translations[lang];
        keys.forEach(k => value = value[k]);
        if (value) el.textContent = value;
      });
    }
    setLanguage(currentLang);
    document.getElementById('lang-toggle').addEventListener('click', () => setLanguage(currentLang === 'en' ? 'fa' : 'en'));

    // Load stories from JSON
    async function loadStories() {
      try {
        const res = await fetch('projects.json');
        const items = await res.json();
        const wrap = document.getElementById('stories');
        wrap.innerHTML = '';
        items.forEach(item => {
          const el = document.createElement('article');
          el.className = 'story';
          el.innerHTML = `
            <img class=\"thumb\" src=\"${item.image}\" alt=\"${item.title}\">
            <div class=\"story-body\">
              <h3>${item.title}</h3>
              <div class=\"meta\">
                ${item.language ? `<span class=\\\"chip\\\">${item.language}</span>` : ''}
                ${item.stack ? item.stack.map(s => `<span class=\\\"chip\\\">${s}</span>`).join('') : ''}
              </div>
              ${item.snippet ? `<pre><code>${escapeHtml(item.snippet)}</code></pre>` : ''}
              ${item.learnings ? `<div><strong data-i18n=\\\"stories.learnings\\\">${currentLang==='fa'?'آموخته‌ها':'Learnings'}</strong><div style=\\\"color:#666; margin-top:6px\\\">${item.learnings}</div></div>` : ''}
              ${item.link ? `<a class=\"btn\" href=\"${item.link}\" target=\"_blank\" rel=\"noopener\" data-i18n=\"stories.view\">${currentLang==='fa'?'مشاهده پروژه':'View Project'}</a>` : ''}
            </div>
          `;
          wrap.appendChild(el);
        });
      } catch (e) {
        document.getElementById('stories').innerHTML = '<div style="opacity:0.8">No stories yet. Add some to projects.json.</div>';
      }
    }
    function escapeHtml(str){return String(str).replace(/[&<>"']/g,m=>({"&":"&amp;","<":"&lt;",
">":"&gt;","\"":"&quot;","'":"&#39;"}[m]))}

    loadStories();
    document.getElementById('year').textContent = new Date().getFullYear();
  </script>
</body>
</html>

